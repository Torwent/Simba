{$assertions on}

var img: TImage;
begin
  with TImagePool.Create() do
  try
    img := TImage.Create();
    img.SetSize(100,100);
    img := img.Threshold.Copy.Invert;
    Assert(Count=4); // in total 4 images have been created in this pool
  finally
    Free([img]); // free all images in the pool but `img`
  end;
  Assert(img.Width = 100);
  img.Free();
end.
